<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>AWS Networking :: Terminal</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Networking, one of the core concepts when it comes to backend engineering. What is the very first that comes into your mind when you hear the word networking.
It&rsquo;s meeting/contacting/communication new people/objects/servers.
In this blog we&rsquo;ll specifically learn about networking in the context of our aws stack.
Virtual Private Cloud A Virtual Private Cloud (VPC) is like your own private, customizable, and secure space in the cloud. It’s where you can build, organize, and protect your applications and data, just like building and securing a house in a gated community.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="/posts/aws-networking/" />





  
  <link rel="stylesheet" href="/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css">

  
  <link rel="stylesheet" href="/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css">

  
  <link rel="stylesheet" href="/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="/css/main.min.fe8dc560fccb53a458b0db19ccb7b265764ac46b68596b7e099c6793054dd457.css">

  
  <link rel="stylesheet" href="/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css">

  
  <link rel="stylesheet" href="/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="/css/post.min.fc74ca360273c1d828da3c02b8174eba435607b369d98418ccc6f2243cd4e75d.css">

  
  <link rel="stylesheet" href="/css/prism.min.9023bbc24533d09e97a51a0a42a5a7bfe4c591ae167c5551fb1d2191d11977c0.css">

  
  <link rel="stylesheet" href="/css/syntax.min.cc789ed9377260d7949ea4c18781fc58959a89287210fe4edbff44ebfc1511b6.css">

  
  <link rel="stylesheet" href="/css/terminal.min.4b367d85d0d0061435650561285afed36c46a7cf8dc6d7ed5642d98e589fa622.css">

  
  <link rel="stylesheet" href="/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="/favicon.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="AWS Networking">
<meta property="og:description" content="Networking, one of the core concepts when it comes to backend engineering. What is the very first that comes into your mind when you hear the word networking.
It&rsquo;s meeting/contacting/communication new people/objects/servers.
In this blog we&rsquo;ll specifically learn about networking in the context of our aws stack.
Virtual Private Cloud A Virtual Private Cloud (VPC) is like your own private, customizable, and secure space in the cloud. It’s where you can build, organize, and protect your applications and data, just like building and securing a house in a gated community.
" />
<meta property="og:url" content="/posts/aws-networking/" />
<meta property="og:site_name" content="Terminal" />

  <meta property="og:image" content="/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-03-06 00:00:00 &#43;0000 UTC" />












</head>
<body>


<div class="container">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/showcase">Showcase</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="/showcase" >Showcase</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="/posts/aws-networking/">AWS Networking</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-03-06</time></div>

  
  


  

  <div class="post-content"><div>
        <p>Networking, one of the core concepts when it comes to backend engineering.
What is the very first that comes into your mind when you hear the word networking.</p>
<p>It&rsquo;s meeting/contacting/communication new people/objects/servers.</p>
<p>In this blog we&rsquo;ll specifically learn about networking in the context of our aws stack.</p>
<h2 id="virtual-private-cloud">Virtual Private Cloud<a href="#virtual-private-cloud" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>A <strong>Virtual Private Cloud (VPC)</strong> is like your own private, customizable, and secure space in the cloud. It’s where you can build, organize, and protect your applications and data, just like building and securing a house in a gated community.</p>
<p>VPC&rsquo;s in the context of AWS can live inside a region, they cannot communicate across regions.
A VPC is a logically isolated portion of the AWS cloud within a region.</p>
<p>Inside a VPC we can create multiple subnets within an availability zone. A subnet is always assigned to a singe availability zone but there can be many subnets in a single availability zone.
It can&rsquo;t span across multiple az&rsquo;s.</p>
<p>VPC Router - It takes care of all the routing and data connection that goes out of the subnet , i can be routed to another subnet or somewhere outside in the internet.
The vpc router is not something that we can see all we see is the route table from where destination and target are configured.</p>
<p>![[Pasted image 20250305201409.png]]</p>
<p>To connect our VPC to the internet there is something present known as the Internet Gateway, that allows to send data out to the internet, egress traffic. And allows data to travel from the internet to the vpc, ingress traffic. There can be only one internet gateway per vpc.</p>
<p>We configure our route table to the internet gateway id that tells it to send all the traffic that doesn&rsquo;t fit one of the networks in the route table to the internet gateway.</p>
<p>There can be multiple vpc&rsquo;s in a single aws region
Each vpc has a CIDR block.
CIDR stands for Classless Interdomain Routing
CIDR block is the overall block of addresses from which you then create the addresses we assign to the subnet. So it&rsquo;s kind of like a master block of addresses.
Each vpc has a different block of IP addresses .</p>
<p>From the CIDR block we can then create the network id&rsquo;s for our subnet.
And they fit within the overall address block. But they have a different subnet mask,
so essentially thats a subset of the overall available addresses and this is why it&rsquo;s really important to make sure we specify our cidr blocks correctly so that we have enough networks and enough hosts per network.</p>
<p>A high level overview of each of the component:</p>
<p>![[Pasted image 20250306094316.png]]</p>
<p>![[Pasted image 20250306094724.png]]</p>
<h3 id="defining-vpc-cidr-blocks">Defining VPC CIDR Blocks<a href="#defining-vpc-cidr-blocks" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Rules and Guidelines</p>
<ul>
<li>CIDR block size can be between /16 and /28</li>
<li>The CIDR block must not overlap with any existing CIDR block that&rsquo;s associated with the VPC</li>
<li>You cannot increase or decrease the size of an existing CIDR block.</li>
<li>The first four and last IP address are not available for use.</li>
<li>AWS recommend to use CIDR blocks from the RFC1918 ranges:</li>
</ul>
<p>![[Pasted image 20250306203630.png]]</p>
<p>![[Pasted image 20250306203827.png]]</p>
<p>10.0.0.0/16</p>
<p>Subnet 1 - 10.0.1.0/24
Subnet 2 - 10.0.2.0/24</p>
<p>Each of the subnet will have 254 addresses to allot to the ec2.</p>
<p>Additional Considerations</p>
<ul>
<li>Ensure you have enough networks and hosts</li>
<li>Bigger CIDR blocks are typically better (more flexibility)</li>
<li>Smaller subnets are OK for most use cases</li>
<li>Consider deploying application tiers per subnet</li>
<li>VPC peering requires non-overlapping CIDR blocks.</li>
</ul>
<p>![[Pasted image 20250306204321.png]]</p>
<h2 id="creating-a-custom-vpc">Creating a custom vpc.<a href="#creating-a-custom-vpc" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>![[Pasted image 20250309222000.png]]</p>
<p>We&rsquo;re going to create a vpc with a 10.0.0.0/16 CIDR block.</p>
<p>The 1a 1b in the subnet name are associated to the availability zone they&rsquo;re present in.</p>
<p>Also the private and public subn. ets have different route table, the MAIN table has a route to internet.</p>
<p>To create a new vpc, open the vpc dashboard  -&gt; Your VPC&rsquo;s  -&gt; Create VPC.</p>
<p>Step 1. Give a name to the vpc</p>
<p>Step 2. Assign a cidr block to the vpc.</p>
<p>Step 3. Open the actions tab and also enable the domain hostname. That means we&rsquo;ll get the dns hostname for our ec2 instances.</p>
<p>Step 4. Create subnets
i. Subnets tab -&gt; Create subnet, select the vpc created before
ii. Give a name to your subnet
iii. Associate it to an availability zone
iv. Assign a IPv4 CIDR block to it</p>
<p>Likewise create all the 4 subnets.</p>
<p>Step 5. For our public subnets -&gt; Go to setting -&gt; Modify auto-assign IP settings and enable the auto-assign public IPv4 address.</p>
<p>Step 6. Create route table for the private subnets -&gt; Go to the route table dashboard -&gt; Create route table
i. Enter a name for our route table
ii. Select a vpc</p>
<p>Step 7. Associate route table to the private subnet -&gt; From the route table dashboard -&gt; Go to edit subnet associations -&gt; Select the private subnets.</p>
<p>Step 8. Creating the internet gateway  -&gt; Go to the internet gateway dashboard -&gt; Create internet gateway , give it a name and create the gateway.</p>
<p>Step 9. Attaching the internet gateway -&gt; From the internet gateways dashboard -&gt; Go to actions -&gt; Attach to VPC.</p>
<p>Step 10. Adding a route to the internet gateway from our MAIN route table -&gt; Go to route tables dashboard, select the public route table -&gt; Select the routes tab -&gt; Edit route -&gt; Add route -&gt; select 0.0.0.0/0 -&gt; select our internet gateway as the target.</p>
<h2 id="launching-ec2-instances-in-the-vpc">Launching EC2 instances in the vpc<a href="#launching-ec2-instances-in-the-vpc" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Create a NAT gateway.</p>
<p>What is a NAT gateway?</p>
<p>-&gt; NAT gateway is a service that allows private network resources to access the internet while keeping them secure.
It translates private IP addresses to public IP addresses.</p>
<p>Why do we need a NAT gateway?</p>
<p>-&gt; After launching an ec2 instance, we need to get some binaries downloaded for which we need to have a internet connection &amp; to be able to connect to the internet from our private subnet we need to have a NAT gateway.</p>
<p>After creating the NAT gateway, we have to alter the route table of our private subnet, add an ip address of 0.0.0.0/0 and associate it to the NAT gateway.</p>
<p>Create a Security Group</p>
<p>-&gt; Security group is a firewall that allows/denies any inbound or outgoing traffic from our network, for now we&rsquo;ll allow all the traffic from both inbound and outbound.</p>
<p>Launching an instance using the cli</p>
<pre tabindex="0"><code>aws ec2 run-instances --image-id &lt;imageid&gt; --instance-type &lt;value&gt; --security-group-ids &lt;value&gt; --subnet-id &lt;value&gt; --key-name &lt;value&gt; --user-data file:// &lt;value&gt;
</code></pre><h2 id="security-groups-and-network-acls">Security Groups and Network ACLs<a href="#security-groups-and-network-acls" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>![[Pasted image 20250310142422.png]]</p>
<p>Both network acl and security groups are two different kinds of firewall,
network acl is a firewall acting at the subnet level whereas security groups are applied at the instance level, the network interface of the instances.</p>
<p>Stateful vs Stateless Firewalls</p>
<p>![[Pasted image 20250310143109.png]]</p>
<p>The security group is a stateful firewall whereas the network acl is a stateless firewall.
The whole concept of stateful and stateless just revolves around how different firewall investigates the return traffic.</p>
<p>As in the picture above.
A client connecting to our webserver, which is considered as an inbound traffic has the entry in the route table accordingly.
Security groups automatically allows the return traffic thus stateful.
Whereas network acls do check for the outbound traffic even if the outbound message is going to the same connection from which it has received some incoming message.</p>
<p>Security groups don&rsquo;t have to have a rule for the return traffic but we might need an outbound rule for traffic going out from our instances or when our instances are initiating connections outbound.</p>
<p>![[Pasted image 20250310144533.png]]</p>
<h2 id="vpc-peering">VPC Peering<a href="#vpc-peering" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>It allows routing internally between two instances from different vpc to each other using either private IPv4 or IPv6 addresses.
What it means by internally that it does not goes out to the internet, its using the aws global network to route traffic between the vpc. It does get encrypted when it moves between regions.</p>
<p>The CIDR blocks of two vpc thats needed to be connected using the vpc peering should not overlap.</p>
<p>VPC peering connections does not support transitive routing meaning -
if VPC A is connected to VPC B and VPC B is connected to VPC C then VPC A cannot directly connect to VPC C, we would need to establish a new vpc peering connection between A and C.</p>
<p>![[Pasted image 20250312232049.png]]</p>
<p>![[Pasted image 20250312232915.png]]</p>
<h2 id="vpc-endpoints">VPC Endpoints<a href="#vpc-endpoints" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Some aws services are private and they run within a vpc like ec2 whereas other services are public as they have a public endpoint like aws s3.
That means when we connect to amazon s3, we use a public dns name.
What if we want to connect an ec2 to s3 but you didn&rsquo;t want to use the public internet that&rsquo;s where the vpc endpoint comes in.
There are a few use cases to vpc endpoint wherein connecting a private ec2 instance to s3 is one of them.</p>
<p>They are of two different types, there is a vpc interface endpoint and a vpc gateway endpoint.</p>
<ol>
<li>
<p>Interface endpoint supports many aws managed services, endpoint services hosted by other AWS customers and partners and supported AWS Marketplace partner services. Gateway endpoint supports connectivity to Amazon S3 and Amazon Dynamo DB.</p>
</li>
<li>
<p>Interface a group of elastic network interfaces (ENI) created by the VPC in the subnet you specify. Each ENI is assigned a private IP address and servers as the primary entry point for traffic directed to supported service.</p>
</li>
<li>
<p>Gateway endpoint functions similarly to an Internet Gateway but is specifically designed to route traffic within an Amazon VPC to a predefined prefix list. This prefix list contains IP ranges used by Amazon DynamoDB and Amazon S3.</p>
<p>Interface Endpoint
![[Pasted image 20250314220954.png]]</p>
<p>Gateway Endpoint</p>
</li>
</ol>
<p>![[Pasted image 20250314221412.png]]</p>
<p>![[Pasted image 20250314221440.png]]</p>
<h2 id="aws-direct-connect">AWS Direct Connect<a href="#aws-direct-connect" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>VPN&rsquo;s typically runs over the public internet that means we&rsquo;re subject to the bandwidth constraints and the potential latency issues on the internet.
So, one of the solutions to that is using Direct Connect. It means that we have a private connection into AWS that means it is not shared.</p>
<p>How direct connect works is, there are AWS direct connect locations installed at various places around the world. So we need to find one near our corporate data center.</p>
<p>In the direct connect location, AWS has a cage, they have a rack full of their own equipment and then there is a customer/partner cage, a rack full of the customer&rsquo;s equipments.</p>
<p>![[Pasted image 20250314225637.png]]</p>
<h2 id="vpc-flow-logs">VPC Flow Logs<a href="#vpc-flow-logs" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Flow logs capture information about the IP traffic going to and from network interface in a VPC.
Flow log data is stored using Amazon CloudWatch Logs or S3
Flow logs can be create at the following levels:</p>
<ul>
<li>VPC</li>
<li>Subnet</li>
<li>Network Interface</li>
</ul>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read other posts</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
    
    
      <a href="/posts/shazams-algorithm/" class="button inline next">
        Shazam&#39;s Algorithm
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
